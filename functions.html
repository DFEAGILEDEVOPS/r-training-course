<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R Training: The new Excel, and more</title>
  <meta name="description" content="This resource is an introduction to the R programming language. It can be used as standalone learning tool, or as part of training sessions.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R Training: The new Excel, and more" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This resource is an introduction to the R programming language. It can be used as standalone learning tool, or as part of training sessions." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R Training: The new Excel, and more" />
  
  <meta name="twitter:description" content="This resource is an introduction to the R programming language. It can be used as standalone learning tool, or as part of training sessions." />
  




  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="iteration.html">
<link rel="next" href="maps.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introductory R Training</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="getting-started-with-rstudio.html"><a href="getting-started-with-rstudio.html"><i class="fa fa-check"></i><b>1</b> Getting Started with RStudio</a><ul>
<li class="chapter" data-level="1.1" data-path="getting-started-with-rstudio.html"><a href="getting-started-with-rstudio.html#opening-r-studio"><i class="fa fa-check"></i><b>1.1</b> Opening R Studio</a></li>
<li class="chapter" data-level="1.2" data-path="getting-started-with-rstudio.html"><a href="getting-started-with-rstudio.html#r-studio-layout"><i class="fa fa-check"></i><b>1.2</b> R Studio Layout</a></li>
<li class="chapter" data-level="1.3" data-path="getting-started-with-rstudio.html"><a href="getting-started-with-rstudio.html#setting-up-a-project"><i class="fa fa-check"></i><b>1.3</b> Setting up a project</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>2</b> Data</a></li>
<li class="chapter" data-level="3" data-path="general-coding.html"><a href="general-coding.html"><i class="fa fa-check"></i><b>3</b> General Coding</a><ul>
<li class="chapter" data-level="3.1" data-path="general-coding.html"><a href="general-coding.html#objects"><i class="fa fa-check"></i><b>3.1</b> Objects</a></li>
<li class="chapter" data-level="3.2" data-path="general-coding.html"><a href="general-coding.html#comments"><i class="fa fa-check"></i><b>3.2</b> Comments</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="loading-and-exploring-data.html"><a href="loading-and-exploring-data.html"><i class="fa fa-check"></i><b>4</b> Loading and Exploring Data</a><ul>
<li class="chapter" data-level="4.1" data-path="loading-and-exploring-data.html"><a href="loading-and-exploring-data.html#loading-in-data"><i class="fa fa-check"></i><b>4.1</b> Loading in data</a></li>
<li class="chapter" data-level="4.2" data-path="loading-and-exploring-data.html"><a href="loading-and-exploring-data.html#basic-dataframe-functions"><i class="fa fa-check"></i><b>4.2</b> Basic dataframe functions</a></li>
<li class="chapter" data-level="4.3" data-path="loading-and-exploring-data.html"><a href="loading-and-exploring-data.html#selecting-certain-columnsremoving-columns"><i class="fa fa-check"></i><b>4.3</b> Selecting certain columns/removing columns</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="manipulating-dataframes.html"><a href="manipulating-dataframes.html"><i class="fa fa-check"></i><b>5</b> Manipulating Dataframes</a><ul>
<li class="chapter" data-level="5.1" data-path="manipulating-dataframes.html"><a href="manipulating-dataframes.html#conditional-selections"><i class="fa fa-check"></i><b>5.1</b> Conditional Selections</a></li>
<li class="chapter" data-level="5.2" data-path="manipulating-dataframes.html"><a href="manipulating-dataframes.html#altering-data-in-dataframes"><i class="fa fa-check"></i><b>5.2</b> Altering data in dataframes</a></li>
<li class="chapter" data-level="5.3" data-path="manipulating-dataframes.html"><a href="manipulating-dataframes.html#writing-data"><i class="fa fa-check"></i><b>5.3</b> Writing data</a></li>
<li class="chapter" data-level="5.4" data-path="manipulating-dataframes.html"><a href="manipulating-dataframes.html#packages"><i class="fa fa-check"></i><b>5.4</b> Packages</a></li>
<li class="chapter" data-level="5.5" data-path="manipulating-dataframes.html"><a href="manipulating-dataframes.html#the-pipe"><i class="fa fa-check"></i><b>5.5</b> The pipe</a></li>
<li class="chapter" data-level="5.6" data-path="manipulating-dataframes.html"><a href="manipulating-dataframes.html#joining"><i class="fa fa-check"></i><b>5.6</b> Joining</a></li>
<li class="chapter" data-level="5.7" data-path="manipulating-dataframes.html"><a href="manipulating-dataframes.html#selecting"><i class="fa fa-check"></i><b>5.7</b> Selecting</a></li>
<li class="chapter" data-level="5.8" data-path="manipulating-dataframes.html"><a href="manipulating-dataframes.html#pivoting"><i class="fa fa-check"></i><b>5.8</b> Pivoting</a></li>
<li class="chapter" data-level="5.9" data-path="manipulating-dataframes.html"><a href="manipulating-dataframes.html#filtering"><i class="fa fa-check"></i><b>5.9</b> Filtering</a></li>
<li class="chapter" data-level="5.10" data-path="manipulating-dataframes.html"><a href="manipulating-dataframes.html#mutating"><i class="fa fa-check"></i><b>5.10</b> Mutating</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="graphs.html"><a href="graphs.html"><i class="fa fa-check"></i><b>6</b> Graphs</a><ul>
<li class="chapter" data-level="6.1" data-path="graphs.html"><a href="graphs.html#ggplot2"><i class="fa fa-check"></i><b>6.1</b> ggplot2</a></li>
<li class="chapter" data-level="6.2" data-path="graphs.html"><a href="graphs.html#scatter-plots"><i class="fa fa-check"></i><b>6.2</b> Scatter plots</a></li>
<li class="chapter" data-level="6.3" data-path="graphs.html"><a href="graphs.html#bar-charts"><i class="fa fa-check"></i><b>6.3</b> Bar charts</a></li>
<li class="chapter" data-level="6.4" data-path="graphs.html"><a href="graphs.html#line-graphs"><i class="fa fa-check"></i><b>6.4</b> Line graphs</a></li>
<li class="chapter" data-level="6.5" data-path="graphs.html"><a href="graphs.html#displaying-a-third-variable"><i class="fa fa-check"></i><b>6.5</b> Displaying a third variable</a></li>
<li class="chapter" data-level="6.6" data-path="graphs.html"><a href="graphs.html#styles"><i class="fa fa-check"></i><b>6.6</b> Styles</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistical-operations.html"><a href="statistical-operations.html"><i class="fa fa-check"></i><b>7</b> Statistical Operations</a><ul>
<li class="chapter" data-level="7.1" data-path="statistical-operations.html"><a href="statistical-operations.html#maximum-minimum-and-range"><i class="fa fa-check"></i><b>7.1</b> Maximum, Minimum, and Range</a></li>
<li class="chapter" data-level="7.2" data-path="statistical-operations.html"><a href="statistical-operations.html#averages"><i class="fa fa-check"></i><b>7.2</b> Averages</a></li>
<li class="chapter" data-level="7.3" data-path="statistical-operations.html"><a href="statistical-operations.html#correlations"><i class="fa fa-check"></i><b>7.3</b> Correlations</a></li>
<li class="chapter" data-level="7.4" data-path="statistical-operations.html"><a href="statistical-operations.html#significance-testing"><i class="fa fa-check"></i><b>7.4</b> Significance Testing</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="iteration.html"><a href="iteration.html"><i class="fa fa-check"></i><b>8</b> Iteration</a><ul>
<li class="chapter" data-level="8.1" data-path="iteration.html"><a href="iteration.html#if"><i class="fa fa-check"></i><b>8.1</b> if</a></li>
<li class="chapter" data-level="8.2" data-path="iteration.html"><a href="iteration.html#for-loops"><i class="fa fa-check"></i><b>8.2</b> for loops</a></li>
<li class="chapter" data-level="8.3" data-path="iteration.html"><a href="iteration.html#while-loops"><i class="fa fa-check"></i><b>8.3</b> while loops</a></li>
<li class="chapter" data-level="8.4" data-path="iteration.html"><a href="iteration.html#how-could-we-use-loops"><i class="fa fa-check"></i><b>8.4</b> How could we use loops?</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>9</b> Functions</a><ul>
<li class="chapter" data-level="9.1" data-path="functions.html"><a href="functions.html#writing-functions"><i class="fa fa-check"></i><b>9.1</b> Writing functions</a></li>
<li class="chapter" data-level="9.2" data-path="functions.html"><a href="functions.html#applying-functions-repetitively"><i class="fa fa-check"></i><b>9.2</b> Applying functions repetitively</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="maps.html"><a href="maps.html"><i class="fa fa-check"></i><b>10</b> Maps</a><ul>
<li class="chapter" data-level="10.1" data-path="maps.html"><a href="maps.html#loading-in-geospatial-data"><i class="fa fa-check"></i><b>10.1</b> Loading in geospatial data</a></li>
<li class="chapter" data-level="10.2" data-path="maps.html"><a href="maps.html#coordinate-systems"><i class="fa fa-check"></i><b>10.2</b> Coordinate systems</a></li>
<li class="chapter" data-level="10.3" data-path="maps.html"><a href="maps.html#transforming-mapping-data"><i class="fa fa-check"></i><b>10.3</b> Transforming mapping data</a></li>
<li class="chapter" data-level="10.4" data-path="maps.html"><a href="maps.html#point-maps"><i class="fa fa-check"></i><b>10.4</b> Point maps</a></li>
<li class="chapter" data-level="10.5" data-path="maps.html"><a href="maps.html#chloropleth-maps"><i class="fa fa-check"></i><b>10.5</b> Chloropleth maps</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="r-markdown.html"><a href="r-markdown.html"><i class="fa fa-check"></i><b>11</b> R Markdown</a><ul>
<li class="chapter" data-level="11.1" data-path="r-markdown.html"><a href="r-markdown.html#text"><i class="fa fa-check"></i><b>11.1</b> Text</a></li>
<li class="chapter" data-level="11.2" data-path="r-markdown.html"><a href="r-markdown.html#code"><i class="fa fa-check"></i><b>11.2</b> Code</a></li>
<li class="chapter" data-level="11.3" data-path="r-markdown.html"><a href="r-markdown.html#multiple-reports"><i class="fa fa-check"></i><b>11.3</b> Multiple Reports</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Training: The new Excel, and more</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="functions" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Functions</h1>
<p>We’ve used a lot of functions up until now, and understand the format of a function, with the function name and then the arguments inside the brackets. It essentially takes the form:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw">verb</span>(noun,adverbs)</a></code></pre></div>
<p>Where the verb is the thing we want to do, the noun (as the first argument) is the object we want to do it to, and the adverbs (as the subsequent arguments) are the descriptions of how we want to do it.</p>
<p>However, there’s going to come a time when we want to do the same thing again and again, to a lot of different objectives, and there won’t be a specific function to write it. Don’t worry though, you can do write your own functions.</p>
<div id="writing-functions" class="section level2">
<h2><span class="header-section-number">9.1</span> Writing functions</h2>
<p>A function is comprised of three parts:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">function_name &lt;-<span class="st"> </span><span class="cf">function</span>(function_argument1,function_argument2,etc){</a>
<a class="sourceLine" id="cb70-2" data-line-number="2">  function_actions</a>
<a class="sourceLine" id="cb70-3" data-line-number="3">}</a></code></pre></div>
<p>So, a function that divides an object by 100 looks like this:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1">my_func &lt;-<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb71-2" data-line-number="2">  x<span class="op">/</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb71-3" data-line-number="3">}</a></code></pre></div>
<p>Here <span class="code">x</span> is the noun that we’re doing something to. To create the function, simply run that code.</p>
<div class="activity">
<p><b>Activity A10.1:</b> Use <span class="code">mutate</span> and multiply <span class="code">Perc_PT_Teaching_Staff_</span> by 100 in a new column called <span class="code">perc_pt_test</span>.</p>
</div>
<br/>
<div class="activity">
<p><b>Activity A10.2:</b> Remember the code from the iteration section on deciding whether a fictional teacher was male or female?</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1"><span class="cf">if</span>(rand_num<span class="op">&lt;=</span>prob_male){</a>
<a class="sourceLine" id="cb72-2" data-line-number="2">  <span class="kw">print</span>(<span class="st">&quot;M&quot;</span>)</a>
<a class="sourceLine" id="cb72-3" data-line-number="3">}<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb72-4" data-line-number="4">  <span class="kw">print</span>(<span class="st">&quot;F&quot;</span>)</a>
<a class="sourceLine" id="cb72-5" data-line-number="5">}</a></code></pre></div>
<p>Turn that into a function, with the random number as the ‘noun’.</p>
<p>Once you’ve written it, run it with a few different numbers in the argument.</p>
</div>
<p><br/></p>
<p>It’s also really handy for producing graphs when we want to filter them by different categories. Say we wanted to look at a histogram of the total school workforce, to get an idea of the distribution of school sizes in a particular region, we could make a graph like this (with Inner London as an example):</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1"><span class="kw">ggplot</span>(swfc_<span class="dv">16</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Government_Office_Region_Name <span class="op">==</span><span class="st"> &#39;Inner London&#39;</span>),</a>
<a class="sourceLine" id="cb73-2" data-line-number="2">     <span class="kw">aes</span>(Tot_Workforce_HC)) <span class="op">+</span></a>
<a class="sourceLine" id="cb73-3" data-line-number="3"><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb73-4" data-line-number="4"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Distribution of school size in Inner London&#39;</span>)</a></code></pre></div>
<p><img src="book_files/figure-html/sec10_5-1.png" width="672" /></p>
<p>However, ‘Inner London’ could be any one of the 9 other regions in England - we could vary this value. By varying it we are making it a parameter - a value in our input code that can change.</p>
<p>We can produce exactly the same output by replacing the string ‘Inner London’ with an object name, and creating that object before we create the graph (remember the <span class="code">paste0</span> function that we used in the iteration section).
<br/></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1">region_name &lt;-<span class="st"> &#39;Inner London&#39;</span></a>
<a class="sourceLine" id="cb74-2" data-line-number="2"></a>
<a class="sourceLine" id="cb74-3" data-line-number="3"><span class="kw">ggplot</span>(swfc_<span class="dv">16</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Government_Office_Region_Name <span class="op">==</span><span class="st"> </span>region_name),</a>
<a class="sourceLine" id="cb74-4" data-line-number="4">     <span class="kw">aes</span>(Tot_Workforce_HC)) <span class="op">+</span></a>
<a class="sourceLine" id="cb74-5" data-line-number="5"><span class="kw">geom_histogram</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb74-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="kw">paste0</span>(<span class="st">&#39;Distribution of school size in &#39;</span>,region_name))</a></code></pre></div>
<p><img src="book_files/figure-html/sec10_6-1.png" width="672" /></p>
<div class="activity">
<p><b>Activity A10.3:</b> Using the code above, create a function which you could put in any region name, and as long as that region is correct, the function produces a graph.</p>
</div>
</div>
<div id="applying-functions-repetitively" class="section level2">
<h2><span class="header-section-number">9.2</span> Applying functions repetitively</h2>
<p>Writing a lot of code get boring and laborious. Writing a lot of code that does the same thing again and again gets really boring and laborious. It can also lead to errors - if you copy and paste code enough times eventually you’ll make a mistake, which could lead to incorrect analysis.</p>
<p>However, as already mentioned, if you’re doing something again and again, then building a function is really useful.
Suppose we do want to create graphs of all 10 regions, using the code above? We have the function to produce a graph, what we need now is to work out how to repeat the graph again and again, changing the region parameter.</p>
<p>We could use a <span class="code">for</span> loop, but remember that’s not the most effective way. We want to ‘vectorise our code’.</p>
A function called <span class="code">lapply</span> applies a function to a list of objects.
<br/>
<div class="activity">
<p><b>Activity A10.3:</b> The <span class="code">Government_Office_Region_Name</span> column is a factor column - use <span class="code">levels()</span> to generate a list of the different possible entries to that column</p>
</div>
<p><br/>
The <span class="code">lapply</span> function works in the following way:
<br/></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1"><span class="kw">lapply</span>(multiple_objects_to_apply_function_to,<span class="cf">function</span>(argument_name) <span class="kw">specific_function_to_apply</span>(argument_name))</a></code></pre></div>
<p>The word <span class="code">function</span> at the start of the second argument specifies that you’re about to write a function name, and essentially says ‘make each object in the list in the first argument the value of <span class="code">argument_name</span> and apply the specific function to it’.</p>
You can choose any string you like for <span class="code">argument_name</span>, as long as it’s the same in both places.
<br/>
<div class="activity">
<p><b>Activity A10.3:</b> Use <span class="code">lapply</span> to print a graph showing the distribution of school sizes in the Plot pane for every single region in England.</p>
</div>
<p><br/>
We can also use lapply to do the same thing to data in multiple columns. The difference here is that we want to turn the outputs of the <span class="code">lapply</span> into an object. That object just so happens to be the same thing that goes in to the first argument in <span class="code">lapply</span>. So if we wanted to turn all the columns with ‘Perc’ in the column title, that is those columns that are a percentage, from a number out of 100 to a number out of 1, by dividing by 100, we’d apply the following code:
<br/></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1">swfc_<span class="dv">16</span>[,<span class="kw">grep</span>(<span class="st">&quot;Perc&quot;</span>, <span class="kw">colnames</span>(swfc_<span class="dv">16</span>))] &lt;-<span class="st"> </span><span class="kw">lapply</span>(swfc_<span class="dv">16</span>[,<span class="kw">grep</span>(<span class="st">&quot;Perc&quot;</span>, <span class="kw">colnames</span>(swfc_<span class="dv">16</span>))],<span class="cf">function</span>(x) <span class="kw">my_func</span>(x))</a></code></pre></div>
<p>Let’s break this down:</p>
<ul>
<li><span class="code">swfc_16[,grep(“Perc”, colnames(swfc_16))]</span> are all the columns in <span class="code">swfc_16</span> which contain ‘Perc’. The function <span class="code">grep</span> finds all the columns which contain the substring ‘Perc’.</li>
<li>Within <span class="code">lapply</span>, the first argument is the same set of columns - we’re essentially doing an update on those columns</li>
<li>The function we’re applying is <span class="code">my_func</span>, which divided the object by 100</li>
</ul>
<br/>
<div class="activity">
<p><b>Activity A10.3:</b> Use <span class="code">lapply</span> to turn columns 6 to 10 (<span class="code">swfc_16[,grep(“Perc”, c(6:10))]</span>) into character columns, from factor columns.</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="iteration.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="maps.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
